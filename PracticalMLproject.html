<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Practical Machine Learning Class Project</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>Practical Machine Learning Class Project</h1>

<p>This code builds a classifier to identify the way in which a dumbell was lifted based on a number of measurements. There are five ways that the dumbell can be lifted, including one correct method. The analysis uses the Weight Lifting Exercise Dataset (<a href="http://groupware.les.inf.puc-rio.br/har">http://groupware.les.inf.puc-rio.br/har</a>).</p>

<p>The approach I took was to first create a test set, then eliminate variables that provided little information, and then use random forests to build  models and test them.  For random forests, getting the out-of-bag error is the equivalent to performing a cross-validation test.  I chose the model with the lowest out-of-bag error rate, and then tested the model on the testing data set to estimate Out-of-sample error rate. </p>

<p>First, load the data and separate out a training and a test set.  This also loads the Test Data for submitting model predictions.</p>

<pre><code class="r">library(randomForest)
</code></pre>

<pre><code>## Warning: package &#39;randomForest&#39; was built under R version 3.1.2
</code></pre>

<pre><code>## randomForest 4.6-10
## Type rfNews() to see new features/changes/bug fixes.
</code></pre>

<pre><code class="r">library(caret)
</code></pre>

<pre><code>## Warning: package &#39;caret&#39; was built under R version 3.1.2
</code></pre>

<pre><code>## Loading required package: lattice
## Loading required package: ggplot2
</code></pre>

<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.1.2
</code></pre>

<pre><code class="r">library(ggplot2)

fileUrltrain&lt;-&quot;https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv&quot;
fileUrltest&lt;-&quot;https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv&quot;

setInternet2(use = TRUE)

training&lt;-read.csv(file=url(fileUrltrain),stringsAsFactors=FALSE)

inTrain&lt;-createDataPartition(y=training$classe,p=0.8,list=FALSE)
trainingSet&lt;-training[inTrain,]
toTest&lt;-training[-inTrain,]

#TestData for later
TestData&lt;-read.csv(file=url(fileUrltest),stringsAsFactor=FALSE)
</code></pre>

<p>These next sections remove variables that aren&#39;t helpful from the training set.</p>

<p>First,remove variables with near zero variance:</p>

<pre><code class="r">nsv&lt;-nearZeroVar(trainingSet,saveMetrics=TRUE)
nzv&lt;-nsv$nzv
table(nzv)
</code></pre>

<pre><code>## nzv
## FALSE  TRUE 
##   101    59
</code></pre>

<pre><code class="r">trainingSetn&lt;-trainingSet[,!nzv]
dim(trainingSetn)
</code></pre>

<pre><code>## [1] 15699   101
</code></pre>

<pre><code class="r">summary(trainingSetn)
</code></pre>

<pre><code>##        X          user_name         raw_timestamp_part_1
##  Min.   :    1   Length:15699       Min.   :1.322e+09   
##  1st Qu.: 4922   Class :character   1st Qu.:1.323e+09   
##  Median : 9828   Mode  :character   Median :1.323e+09   
##  Mean   : 9815                      Mean   :1.323e+09   
##  3rd Qu.:14732                      3rd Qu.:1.323e+09   
##  Max.   :19621                      Max.   :1.323e+09   
##                                                         
##  raw_timestamp_part_2 cvtd_timestamp       num_window      roll_belt    
##  Min.   :   301       Length:15699       Min.   :  1.0   Min.   :-28.9  
##  1st Qu.:256301       Class :character   1st Qu.:223.0   1st Qu.:  1.1  
##  Median :500314       Mode  :character   Median :424.0   Median :114.0  
##  Mean   :503196                          Mean   :431.5   Mean   : 64.6  
##  3rd Qu.:752315                          3rd Qu.:644.0   3rd Qu.:123.0  
##  Max.   :998801                          Max.   :864.0   Max.   :162.0  
##                                                                         
##    pitch_belt          yaw_belt       total_accel_belt max_roll_belt    
##  Min.   :-55.8000   Min.   :-179.00   Min.   : 0.00    Min.   :-94.300  
##  1st Qu.:  1.6700   1st Qu.: -88.30   1st Qu.: 3.00    1st Qu.:-87.925  
##  Median :  5.2800   Median : -12.80   Median :17.00    Median : -5.550  
##  Mean   :  0.2104   Mean   : -10.81   Mean   :11.33    Mean   : -6.711  
##  3rd Qu.: 14.9000   3rd Qu.:  13.80   3rd Qu.:18.00    3rd Qu.: 20.025  
##  Max.   : 60.2000   Max.   : 179.00   Max.   :29.00    Max.   :180.000  
##                                                        NA&#39;s   :15379    
##  max_picth_belt  min_roll_belt     min_pitch_belt  amplitude_roll_belt
##  Min.   : 3      Min.   :-180.00   Min.   : 0.00   Min.   :  0.000    
##  1st Qu.: 5      1st Qu.: -88.40   1st Qu.: 3.00   1st Qu.:  0.300    
##  Median :18      Median :  -7.85   Median :16.00   Median :  1.000    
##  Mean   :13      Mean   : -11.00   Mean   :10.74   Mean   :  4.289    
##  3rd Qu.:19      3rd Qu.:  10.68   3rd Qu.:17.00   3rd Qu.:  2.232    
##  Max.   :30      Max.   : 173.00   Max.   :22.00   Max.   :360.000    
##  NA&#39;s   :15379   NA&#39;s   :15379     NA&#39;s   :15379   NA&#39;s   :15379      
##  amplitude_pitch_belt var_total_accel_belt avg_roll_belt   
##  Min.   : 0.000       Min.   : 0.000       Min.   :-27.40  
##  1st Qu.: 1.000       1st Qu.: 0.100       1st Qu.:  1.10  
##  Median : 1.000       Median : 0.200       Median :116.20  
##  Mean   : 2.253       Mean   : 0.995       Mean   : 68.24  
##  3rd Qu.: 2.000       3rd Qu.: 0.300       3rd Qu.:123.62  
##  Max.   :12.000       Max.   :16.500       Max.   :157.40  
##  NA&#39;s   :15379        NA&#39;s   :15379        NA&#39;s   :15379   
##  stddev_roll_belt var_roll_belt     avg_pitch_belt    stddev_pitch_belt
##  Min.   : 0.000   Min.   :  0.000   Min.   :-51.400   Min.   :0.000    
##  1st Qu.: 0.200   1st Qu.:  0.000   1st Qu.:  1.975   1st Qu.:0.200    
##  Median : 0.400   Median :  0.100   Median :  5.200   Median :0.322    
##  Mean   : 1.424   Mean   :  8.566   Mean   :  0.613   Mean   :0.618    
##  3rd Qu.: 0.700   3rd Qu.:  0.500   3rd Qu.: 15.825   3rd Qu.:0.700    
##  Max.   :14.200   Max.   :200.700   Max.   : 59.700   Max.   :4.000    
##  NA&#39;s   :15379    NA&#39;s   :15379     NA&#39;s   :15379     NA&#39;s   :15379    
##  var_pitch_belt    avg_yaw_belt      stddev_yaw_belt    var_yaw_belt      
##  Min.   : 0.000   Min.   :-138.300   Min.   :  0.000   Min.   :    0.000  
##  1st Qu.: 0.000   1st Qu.: -88.100   1st Qu.:  0.100   1st Qu.:    0.010  
##  Median : 0.100   Median :  -6.650   Median :  0.300   Median :    0.095  
##  Mean   : 0.824   Mean   :  -9.216   Mean   :  1.536   Mean   :  136.073  
##  3rd Qu.: 0.525   3rd Qu.:  17.675   3rd Qu.:  0.700   3rd Qu.:    0.502  
##  Max.   :16.200   Max.   : 173.500   Max.   :176.600   Max.   :31183.240  
##  NA&#39;s   :15379    NA&#39;s   :15379      NA&#39;s   :15379     NA&#39;s   :15379      
##   gyros_belt_x        gyros_belt_y       gyros_belt_z    
##  Min.   :-1.040000   Min.   :-0.64000   Min.   :-1.4600  
##  1st Qu.:-0.030000   1st Qu.: 0.00000   1st Qu.:-0.2000  
##  Median : 0.030000   Median : 0.02000   Median :-0.1000  
##  Mean   :-0.005101   Mean   : 0.03985   Mean   :-0.1306  
##  3rd Qu.: 0.110000   3rd Qu.: 0.11000   3rd Qu.:-0.0200  
##  Max.   : 2.200000   Max.   : 0.64000   Max.   : 1.6200  
##                                                          
##   accel_belt_x       accel_belt_y     accel_belt_z     magnet_belt_x   
##  Min.   :-120.000   Min.   :-65.00   Min.   :-275.00   Min.   :-49.00  
##  1st Qu.: -21.000   1st Qu.:  3.00   1st Qu.:-162.00   1st Qu.:  9.00  
##  Median : -15.000   Median : 35.00   Median :-153.00   Median : 35.00  
##  Mean   :  -5.474   Mean   : 30.21   Mean   : -72.91   Mean   : 55.97  
##  3rd Qu.:  -5.000   3rd Qu.: 61.00   3rd Qu.:  27.00   3rd Qu.: 60.00  
##  Max.   :  85.000   Max.   :164.00   Max.   : 104.00   Max.   :485.00  
##                                                                        
##  magnet_belt_y   magnet_belt_z       roll_arm         pitch_arm      
##  Min.   :354.0   Min.   :-623.0   Min.   :-180.00   Min.   :-88.800  
##  1st Qu.:581.0   1st Qu.:-375.0   1st Qu.: -31.80   1st Qu.:-26.000  
##  Median :601.0   Median :-320.0   Median :   0.00   Median :  0.000  
##  Mean   :593.6   Mean   :-345.6   Mean   :  17.93   Mean   : -4.617  
##  3rd Qu.:610.0   3rd Qu.:-306.0   3rd Qu.:  77.45   3rd Qu.: 11.200  
##  Max.   :673.0   Max.   : 293.0   Max.   : 180.00   Max.   : 88.500  
##                                                                      
##     yaw_arm        total_accel_arm var_accel_arm     gyros_arm_x      
##  Min.   :-180.00   Min.   : 1.0    Min.   :  0.00   Min.   :-6.37000  
##  1st Qu.: -43.05   1st Qu.:17.0    1st Qu.: 11.28   1st Qu.:-1.32000  
##  Median :   0.00   Median :27.0    Median : 40.67   Median : 0.08000  
##  Mean   :  -0.40   Mean   :25.5    Mean   : 53.19   Mean   : 0.05201  
##  3rd Qu.:  46.20   3rd Qu.:33.0    3rd Qu.: 77.51   3rd Qu.: 1.59000  
##  Max.   : 180.00   Max.   :65.0    Max.   :331.70   Max.   : 4.87000  
##                                    NA&#39;s   :15379                      
##   gyros_arm_y       gyros_arm_z       accel_arm_x       accel_arm_y     
##  Min.   :-3.4000   Min.   :-2.3300   Min.   :-404.00   Min.   :-318.00  
##  1st Qu.:-0.8000   1st Qu.:-0.0700   1st Qu.:-241.00   1st Qu.: -54.00  
##  Median :-0.2400   Median : 0.2500   Median : -45.00   Median :  13.00  
##  Mean   :-0.2628   Mean   : 0.2737   Mean   : -60.23   Mean   :  32.34  
##  3rd Qu.: 0.1400   3rd Qu.: 0.7200   3rd Qu.:  83.00   3rd Qu.: 138.50  
##  Max.   : 2.8400   Max.   : 3.0200   Max.   : 437.00   Max.   : 308.00  
##                                                                         
##   accel_arm_z       magnet_arm_x     magnet_arm_y     magnet_arm_z   
##  Min.   :-630.00   Min.   :-584.0   Min.   :-392.0   Min.   :-595.0  
##  1st Qu.:-143.00   1st Qu.:-299.0   1st Qu.:  -9.0   1st Qu.: 129.5  
##  Median : -46.00   Median : 291.0   Median : 202.0   Median : 445.0  
##  Mean   : -71.03   Mean   : 192.5   Mean   : 156.6   Mean   : 306.8  
##  3rd Qu.:  23.00   3rd Qu.: 637.0   3rd Qu.: 322.0   3rd Qu.: 545.0  
##  Max.   : 292.00   Max.   : 782.0   Max.   : 583.0   Max.   : 694.0  
##                                                                      
##  max_picth_arm      max_yaw_arm    min_pitch_arm      min_yaw_arm   
##  Min.   :-173.00   Min.   : 4.00   Min.   :-180.00   Min.   : 1.0   
##  1st Qu.:  -0.20   1st Qu.:29.00   1st Qu.: -70.65   1st Qu.: 8.0   
##  Median :  31.15   Median :34.00   Median : -33.45   Median :12.0   
##  Mean   :  37.68   Mean   :35.28   Mean   : -32.90   Mean   :14.4   
##  3rd Qu.:  97.08   3rd Qu.:41.00   3rd Qu.:   0.00   3rd Qu.:19.0   
##  Max.   : 180.00   Max.   :65.00   Max.   : 152.00   Max.   :38.0   
##  NA&#39;s   :15379     NA&#39;s   :15379   NA&#39;s   :15379     NA&#39;s   :15379  
##  amplitude_yaw_arm roll_dumbbell     pitch_dumbbell     yaw_dumbbell     
##  Min.   : 0.00     Min.   :-153.71   Min.   :-149.59   Min.   :-150.871  
##  1st Qu.:13.00     1st Qu.: -18.90   1st Qu.: -40.69   1st Qu.: -77.664  
##  Median :21.50     Median :  47.88   Median : -21.10   Median :  -2.842  
##  Mean   :20.88     Mean   :  23.50   Mean   : -10.80   Mean   :   1.673  
##  3rd Qu.:29.00     3rd Qu.:  67.32   3rd Qu.:  17.55   3rd Qu.:  79.650  
##  Max.   :51.00     Max.   : 153.55   Max.   : 149.40   Max.   : 154.952  
##  NA&#39;s   :15379                                                           
##  max_roll_dumbbell max_picth_dumbbell min_roll_dumbbell min_pitch_dumbbell
##  Min.   :-70.10    Min.   :-112.90    Min.   :-134.90   Min.   :-147.00   
##  1st Qu.:-26.93    1st Qu.: -66.03    1st Qu.: -60.48   1st Qu.: -89.70   
##  Median : 16.20    Median :  44.40    Median : -44.45   Median : -56.90   
##  Mean   : 15.03    Mean   :  35.04    Mean   : -42.12   Mean   : -33.32   
##  3rd Qu.: 50.80    3rd Qu.: 133.07    3rd Qu.: -28.10   3rd Qu.:  16.40   
##  Max.   :137.00    Max.   : 154.80    Max.   :  73.20   Max.   : 116.60   
##  NA&#39;s   :15379     NA&#39;s   :15379      NA&#39;s   :15379     NA&#39;s   :15379     
##  amplitude_roll_dumbbell amplitude_pitch_dumbbell total_accel_dumbbell
##  Min.   :  0.00          Min.   :  0.00           Min.   : 0.00       
##  1st Qu.: 15.18          1st Qu.: 17.51           1st Qu.: 4.00       
##  Median : 36.34          Median : 42.70           Median :10.00       
##  Mean   : 57.15          Mean   : 68.36           Mean   :13.65       
##  3rd Qu.: 87.92          3rd Qu.:106.09           3rd Qu.:19.00       
##  Max.   :256.48          Max.   :273.59           Max.   :42.00       
##  NA&#39;s   :15379           NA&#39;s   :15379                                
##  var_accel_dumbbell avg_roll_dumbbell stddev_roll_dumbbell
##  Min.   : 0.000     Min.   :-128.96   Min.   :  0.00      
##  1st Qu.: 0.387     1st Qu.: -12.93   1st Qu.:  4.69      
##  Median : 0.944     Median :  47.98   Median : 13.20      
##  Mean   : 3.960     Mean   :  22.33   Mean   : 21.33      
##  3rd Qu.: 3.482     3rd Qu.:  63.98   3rd Qu.: 27.45      
##  Max.   :64.175     Max.   : 125.99   Max.   :107.76      
##  NA&#39;s   :15379      NA&#39;s   :15379     NA&#39;s   :15379       
##  var_roll_dumbbell avg_pitch_dumbbell stddev_pitch_dumbbell
##  Min.   :    0.0   Min.   :-70.73     Min.   : 0.000       
##  1st Qu.:   22.0   1st Qu.:-40.61     1st Qu.: 3.420       
##  Median :  174.2   Median :-19.73     Median : 8.363       
##  Mean   : 1038.0   Mean   :-12.29     Mean   :13.638       
##  3rd Qu.:  753.3   3rd Qu.: 12.71     3rd Qu.:20.109       
##  Max.   :11612.4   Max.   : 93.93     Max.   :82.680       
##  NA&#39;s   :15379     NA&#39;s   :15379      NA&#39;s   :15379        
##  var_pitch_dumbbell avg_yaw_dumbbell   stddev_yaw_dumbbell
##  Min.   :   0.00    Min.   :-117.950   Min.   :  0.000    
##  1st Qu.:  11.70    1st Qu.: -76.659   1st Qu.:  4.055    
##  Median :  69.93    Median :   9.030   Median : 10.819    
##  Mean   : 372.23    Mean   :   1.092   Mean   : 17.327    
##  3rd Qu.: 404.41    3rd Qu.:  70.688   3rd Qu.: 26.444    
##  Max.   :6836.02    Max.   : 134.905   Max.   :107.088    
##  NA&#39;s   :15379      NA&#39;s   :15379      NA&#39;s   :15379      
##  var_yaw_dumbbell   gyros_dumbbell_x gyros_dumbbell_y   gyros_dumbbell_z 
##  Min.   :    0.00   Min.   :-1.990   Min.   :-2.10000   Min.   :-2.3800  
##  1st Qu.:   16.45   1st Qu.:-0.030   1st Qu.:-0.14000   1st Qu.:-0.3100  
##  Median :  117.05   Median : 0.130   Median : 0.03000   Median :-0.1300  
##  Mean   :  631.52   Mean   : 0.171   Mean   : 0.04129   Mean   :-0.1451  
##  3rd Qu.:  699.31   3rd Qu.: 0.350   3rd Qu.: 0.21000   3rd Qu.: 0.0300  
##  Max.   :11467.91   Max.   : 2.220   Max.   : 4.37000   Max.   : 1.8700  
##  NA&#39;s   :15379                                                           
##  accel_dumbbell_x  accel_dumbbell_y  accel_dumbbell_z  magnet_dumbbell_x
##  Min.   :-237.00   Min.   :-189.00   Min.   :-334.00   Min.   :-643.0   
##  1st Qu.: -50.00   1st Qu.:  -8.00   1st Qu.:-141.00   1st Qu.:-536.0   
##  Median :  -8.00   Median :  41.00   Median :  -1.00   Median :-480.0   
##  Mean   : -28.37   Mean   :  52.17   Mean   : -38.25   Mean   :-329.6   
##  3rd Qu.:  11.00   3rd Qu.: 109.00   3rd Qu.:  38.00   3rd Qu.:-308.0   
##  Max.   : 235.00   Max.   : 315.00   Max.   : 318.00   Max.   : 592.0   
##                                                                         
##  magnet_dumbbell_y magnet_dumbbell_z  roll_forearm      pitch_forearm   
##  Min.   :-744.0    Min.   :-262.00   Min.   :-180.000   Min.   :-72.50  
##  1st Qu.: 232.0    1st Qu.: -45.00   1st Qu.:  -0.815   1st Qu.:  0.00  
##  Median : 310.0    Median :  14.00   Median :  20.500   Median :  8.97  
##  Mean   : 221.2    Mean   :  46.45   Mean   :  33.286   Mean   : 10.69  
##  3rd Qu.: 389.0    3rd Qu.:  96.00   3rd Qu.: 140.000   3rd Qu.: 28.20  
##  Max.   : 633.0    Max.   : 452.00   Max.   : 180.000   Max.   : 89.80  
##                                                                         
##   yaw_forearm     max_picth_forearm min_pitch_forearm
##  Min.   :-180.0   Min.   :-151.00   Min.   :-180.00  
##  1st Qu.: -68.6   1st Qu.:   0.00   1st Qu.:-175.00  
##  Median :   0.0   Median : 114.00   Median : -65.05  
##  Mean   :  19.1   Mean   :  82.85   Mean   : -59.75  
##  3rd Qu.: 110.0   3rd Qu.: 175.00   3rd Qu.:   0.00  
##  Max.   : 180.0   Max.   : 180.00   Max.   : 167.00  
##                   NA&#39;s   :15379     NA&#39;s   :15379    
##  amplitude_pitch_forearm total_accel_forearm var_accel_forearm
##  Min.   :  0.0           Min.   : 0.00       Min.   :  0.000  
##  1st Qu.:  2.0           1st Qu.:29.00       1st Qu.:  7.026  
##  Median : 88.8           Median :36.00       Median : 25.025  
##  Mean   :142.6           Mean   :34.66       Mean   : 35.209  
##  3rd Qu.:351.0           3rd Qu.:41.00       3rd Qu.: 54.175  
##  Max.   :360.0           Max.   :79.00       Max.   :172.606  
##  NA&#39;s   :15379                               NA&#39;s   :15379    
##  gyros_forearm_x   gyros_forearm_y    gyros_forearm_z   accel_forearm_x  
##  Min.   :-4.9500   Min.   :-7.02000   Min.   :-7.9400   Min.   :-498.00  
##  1st Qu.:-0.2100   1st Qu.:-1.45000   1st Qu.:-0.1800   1st Qu.:-177.00  
##  Median : 0.0500   Median : 0.03000   Median : 0.0800   Median : -57.00  
##  Mean   : 0.1599   Mean   : 0.06686   Mean   : 0.1422   Mean   : -61.64  
##  3rd Qu.: 0.5600   3rd Qu.: 1.62000   3rd Qu.: 0.4900   3rd Qu.:  75.00  
##  Max.   : 3.5200   Max.   : 6.13000   Max.   : 4.1000   Max.   : 477.00  
##                                                                          
##  accel_forearm_y  accel_forearm_z   magnet_forearm_x  magnet_forearm_y
##  Min.   :-632.0   Min.   :-446.00   Min.   :-1280.0   Min.   :-896.0  
##  1st Qu.:  58.0   1st Qu.:-181.00   1st Qu.: -615.0   1st Qu.:   3.0  
##  Median : 201.0   Median : -38.00   Median : -377.0   Median : 594.0  
##  Mean   : 164.3   Mean   : -54.56   Mean   : -312.3   Mean   : 382.2  
##  3rd Qu.: 312.5   3rd Qu.:  26.00   3rd Qu.:  -76.0   3rd Qu.: 738.0  
##  Max.   : 590.0   Max.   : 291.00   Max.   :  672.0   Max.   :1480.0  
##                                                                       
##  magnet_forearm_z    classe         
##  Min.   :-973.0   Length:15699      
##  1st Qu.: 191.0   Class :character  
##  Median : 511.0   Mode  :character  
##  Mean   : 392.7                     
##  3rd Qu.: 652.0                     
##  Max.   :1090.0                     
## 
</code></pre>

<p>In looking at the summary data above, it is apparent that many variables have majority NA&#39;s. Get list of vars that are mostly NA&#39;s and remove these:</p>

<pre><code class="r">namatrix&lt;-is.na(trainingSetn)
#Next get the number that are true (ie are NA) for each variable
nacounts&lt;-apply(namatrix,2,sum)
#get true false vector for colums on whether number of NAs is less than 11000
naL11K&lt;-nacounts&lt;11000
# keep only colms where NA&#39;s are less than 11K (ie keep colms that don&#39;t have lots of NAs)
trainingSetn1&lt;-trainingSetn[,naL11K]
</code></pre>

<p>This section converts most prediction variables to numeric, and &ldquo;classe&rdquo; and &ldquo;user_name&rdquo; to factor.  It also removes time stamp and order variables, as these should not be useful in predictions for new samples. User_name was kept because data for it are present in the Test Data set.</p>

<pre><code class="r">#First look a the variables to identify ones to eliminate
str(trainingSetn1)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    15699 obs. of  59 variables:
##  $ X                   : int  1 3 4 6 8 10 11 12 13 14 ...
##  $ user_name           : chr  &quot;carlitos&quot; &quot;carlitos&quot; &quot;carlitos&quot; &quot;carlitos&quot; ...
##  $ raw_timestamp_part_1: int  1323084231 1323084231 1323084232 1323084232 1323084232 1323084232 1323084232 1323084232 1323084232 1323084232 ...
##  $ raw_timestamp_part_2: int  788290 820366 120339 304277 440390 484434 500302 528316 560359 576390 ...
##  $ cvtd_timestamp      : chr  &quot;05/12/2011 11:23&quot; &quot;05/12/2011 11:23&quot; &quot;05/12/2011 11:23&quot; &quot;05/12/2011 11:23&quot; ...
##  $ num_window          : int  11 11 12 12 12 12 12 12 12 12 ...
##  $ roll_belt           : num  1.41 1.42 1.48 1.45 1.42 1.45 1.45 1.43 1.42 1.42 ...
##  $ pitch_belt          : num  8.07 8.07 8.05 8.06 8.13 8.17 8.18 8.18 8.2 8.21 ...
##  $ yaw_belt            : num  -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 ...
##  $ total_accel_belt    : int  3 3 3 3 3 3 3 3 3 3 ...
##  $ gyros_belt_x        : num  0 0 0.02 0.02 0.02 0.03 0.03 0.02 0.02 0.02 ...
##  $ gyros_belt_y        : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ gyros_belt_z        : num  -0.02 -0.02 -0.03 -0.02 -0.02 0 -0.02 -0.02 0 -0.02 ...
##  $ accel_belt_x        : int  -21 -20 -22 -21 -22 -21 -21 -22 -22 -22 ...
##  $ accel_belt_y        : int  4 5 3 4 4 4 2 2 4 4 ...
##  $ accel_belt_z        : int  22 23 21 21 21 22 23 23 21 21 ...
##  $ magnet_belt_x       : int  -3 -2 -6 0 -2 -3 -5 -2 -3 -8 ...
##  $ magnet_belt_y       : int  599 600 604 603 603 609 596 602 606 598 ...
##  $ magnet_belt_z       : int  -313 -305 -310 -312 -313 -308 -317 -319 -309 -310 ...
##  $ roll_arm            : num  -128 -128 -128 -128 -128 -128 -128 -128 -128 -128 ...
##  $ pitch_arm           : num  22.5 22.5 22.1 22 21.8 21.6 21.5 21.5 21.4 21.4 ...
##  $ yaw_arm             : num  -161 -161 -161 -161 -161 -161 -161 -161 -161 -161 ...
##  $ total_accel_arm     : int  34 34 34 34 34 34 34 34 34 34 ...
##  $ gyros_arm_x         : num  0 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 ...
##  $ gyros_arm_y         : num  0 -0.02 -0.03 -0.03 -0.02 -0.03 -0.03 -0.03 -0.02 0 ...
##  $ gyros_arm_z         : num  -0.02 -0.02 0.02 0 0 -0.02 0 0 -0.02 -0.03 ...
##  $ accel_arm_x         : int  -288 -289 -289 -289 -289 -288 -290 -288 -287 -288 ...
##  $ accel_arm_y         : int  109 110 111 111 111 110 110 111 111 111 ...
##  $ accel_arm_z         : int  -123 -126 -123 -122 -124 -124 -123 -123 -124 -124 ...
##  $ magnet_arm_x        : int  -368 -368 -372 -369 -372 -376 -366 -363 -372 -371 ...
##  $ magnet_arm_y        : int  337 344 344 342 338 334 339 343 338 331 ...
##  $ magnet_arm_z        : int  516 513 512 513 510 516 509 520 509 523 ...
##  $ roll_dumbbell       : num  13.1 12.9 13.4 13.4 12.8 ...
##  $ pitch_dumbbell      : num  -70.5 -70.3 -70.4 -70.8 -70.3 ...
##  $ yaw_dumbbell        : num  -84.9 -85.1 -84.9 -84.5 -85.1 ...
##  $ total_accel_dumbbell: int  37 37 37 37 37 37 37 37 37 37 ...
##  $ gyros_dumbbell_x    : num  0 0 0 0 0 0 0 0 0 0.02 ...
##  $ gyros_dumbbell_y    : num  -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 ...
##  $ gyros_dumbbell_z    : num  0 0 -0.02 0 0 0 0 0 -0.02 -0.02 ...
##  $ accel_dumbbell_x    : int  -234 -232 -232 -234 -234 -235 -233 -233 -234 -234 ...
##  $ accel_dumbbell_y    : int  47 46 48 48 46 48 47 47 48 48 ...
##  $ accel_dumbbell_z    : int  -271 -270 -269 -269 -272 -270 -269 -270 -269 -268 ...
##  $ magnet_dumbbell_x   : int  -559 -561 -552 -558 -555 -558 -564 -554 -552 -554 ...
##  $ magnet_dumbbell_y   : int  293 298 303 294 300 291 299 291 302 295 ...
##  $ magnet_dumbbell_z   : num  -65 -63 -60 -66 -74 -69 -64 -65 -69 -68 ...
##  $ roll_forearm        : num  28.4 28.3 28.1 27.9 27.8 27.7 27.6 27.5 27.2 27.2 ...
##  $ pitch_forearm       : num  -63.9 -63.9 -63.9 -63.9 -63.8 -63.8 -63.8 -63.8 -63.9 -63.9 ...
##  $ yaw_forearm         : num  -153 -152 -152 -152 -152 -152 -152 -152 -151 -151 ...
##  $ total_accel_forearm : int  36 36 36 36 36 36 36 36 36 36 ...
##  $ gyros_forearm_x     : num  0.03 0.03 0.02 0.02 0.02 0.02 0.02 0.02 0 0 ...
##  $ gyros_forearm_y     : num  0 -0.02 -0.02 -0.02 -0.02 0 -0.02 0.02 0 -0.02 ...
##  $ gyros_forearm_z     : num  -0.02 0 0 -0.03 0 -0.02 -0.02 -0.03 -0.03 -0.03 ...
##  $ accel_forearm_x     : int  192 196 189 193 193 190 193 191 193 193 ...
##  $ accel_forearm_y     : int  203 204 206 203 205 205 205 203 205 202 ...
##  $ accel_forearm_z     : int  -215 -213 -214 -215 -213 -215 -214 -215 -215 -214 ...
##  $ magnet_forearm_x    : int  -17 -18 -16 -9 -9 -22 -17 -11 -15 -14 ...
##  $ magnet_forearm_y    : num  654 658 658 660 660 656 657 657 655 659 ...
##  $ magnet_forearm_z    : num  476 469 469 478 474 473 465 478 472 478 ...
##  $ classe              : chr  &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; ...
</code></pre>

<pre><code class="r">convert2numeric&lt;-function(df,x,y){
  for (i in x:y){
    df[,i]&lt;-as.numeric(as.character(df[,i]))
  }
  return(df)
}


trainingSetn2N&lt;-convert2numeric(trainingSetn1,x=8,y=(ncol(trainingSetn1)-1))

trainingSetn2Nvars&lt;-trainingSetn2N[,c(2,8:ncol(trainingSetn2N))]
trainingSetn2Nvars$classe&lt;-as.factor(trainingSetn2Nvars$classe)
trainingSetn2Nvars$user_name&lt;-as.factor(trainingSetn2Nvars$user_name)
</code></pre>

<p>This section builds a prediction model using random forests, and displays the out-of-bag error rate, which is equivalent to a cross-validation error rate. It also provides a rank-order list of variable importance.</p>

<pre><code class="r">set.seed(1)
modFit&lt;-randomForest(trainingSetn2Nvars[,1:(ncol(trainingSetn2Nvars)-1)],trainingSetn2Nvars$classe)
modFit
</code></pre>

<pre><code>## 
## Call:
##  randomForest(x = trainingSetn2Nvars[, 1:(ncol(trainingSetn2Nvars) -      1)], y = trainingSetn2Nvars$classe) 
##                Type of random forest: classification
##                      Number of trees: 500
## No. of variables tried at each split: 7
## 
##         OOB estimate of  error rate: 0.44%
## Confusion matrix:
##      A    B    C    D    E  class.error
## A 4463    1    0    0    0 0.0002240143
## B   14 3019    5    0    0 0.0062541145
## C    0   13 2722    3    0 0.0058436815
## D    0    0   24 2547    2 0.0101049359
## E    0    0    2    5 2879 0.0024255024
</code></pre>

<pre><code class="r">x&lt;-varImp(modFit,scale=TRUE)
xa&lt;-cbind(rownames(x),x)
xo&lt;-xa[order(-xa$Overall),]
xo
</code></pre>

<pre><code>##                               rownames(x)   Overall
## yaw_belt                         yaw_belt 852.38319
## pitch_forearm               pitch_forearm 648.50411
## magnet_dumbbell_z       magnet_dumbbell_z 636.40163
## pitch_belt                     pitch_belt 633.49781
## magnet_dumbbell_y       magnet_dumbbell_y 536.08942
## roll_forearm                 roll_forearm 489.39311
## accel_belt_z                 accel_belt_z 410.48287
## magnet_dumbbell_x       magnet_dumbbell_x 388.94467
## magnet_belt_z               magnet_belt_z 375.31519
## magnet_belt_y               magnet_belt_y 347.41238
## roll_dumbbell               roll_dumbbell 345.83072
## accel_dumbbell_y         accel_dumbbell_y 325.67608
## gyros_belt_z                 gyros_belt_z 319.11501
## accel_dumbbell_z         accel_dumbbell_z 278.75143
## roll_arm                         roll_arm 277.33353
## accel_forearm_x           accel_forearm_x 260.91487
## magnet_forearm_z         magnet_forearm_z 243.01182
## total_accel_belt         total_accel_belt 222.54786
## total_accel_dumbbell total_accel_dumbbell 222.30542
## magnet_belt_x               magnet_belt_x 221.04013
## yaw_dumbbell                 yaw_dumbbell 218.76060
## accel_dumbbell_x         accel_dumbbell_x 202.53300
## yaw_arm                           yaw_arm 201.49335
## accel_forearm_z           accel_forearm_z 200.33608
## magnet_arm_x                 magnet_arm_x 198.25908
## accel_arm_x                   accel_arm_x 197.73018
## gyros_dumbbell_y         gyros_dumbbell_y 197.23761
## magnet_arm_y                 magnet_arm_y 192.99596
## magnet_forearm_y         magnet_forearm_y 186.74053
## magnet_forearm_x         magnet_forearm_x 185.81285
## magnet_arm_z                 magnet_arm_z 161.86556
## pitch_arm                       pitch_arm 146.70692
## yaw_forearm                   yaw_forearm 143.08290
## pitch_dumbbell             pitch_dumbbell 139.05980
## accel_arm_y                   accel_arm_y 131.69048
## user_name                       user_name 123.19242
## accel_forearm_y           accel_forearm_y 120.51244
## accel_belt_y                 accel_belt_y 120.34933
## accel_arm_z                   accel_arm_z 118.59319
## gyros_arm_y                   gyros_arm_y 115.86518
## gyros_arm_x                   gyros_arm_x 114.63134
## gyros_forearm_y           gyros_forearm_y 108.53201
## accel_belt_x                 accel_belt_x 107.12681
## gyros_dumbbell_x         gyros_dumbbell_x 106.89776
## gyros_belt_y                 gyros_belt_y 105.58375
## gyros_belt_x                 gyros_belt_x  96.13787
## total_accel_forearm   total_accel_forearm  94.82327
## total_accel_arm           total_accel_arm  83.80387
## gyros_dumbbell_z         gyros_dumbbell_z  70.87748
## gyros_forearm_z           gyros_forearm_z  70.65732
## gyros_forearm_x           gyros_forearm_x  64.61564
## gyros_arm_z                   gyros_arm_z  49.55035
</code></pre>

<p>The Out-of-Bag (OOB) error rate (equivalent to an error rate from cross-validation) for the above model is about 0.4%, which I think is good. (The calcuated error rate for this run is listed as &ldquo;OOB estimate of  error rate&rdquo; above. Note this number varies slightly from run to run  because the model creation has a random component and was rerun in compiling html)</p>

<p>This next section tests whether dropping some of the variables that are not that important (at the bottom of the ranked list) improves the model.</p>

<pre><code class="r">set.seed(1)
trainingSetn2Nvars2&lt;-trainingSetn2Nvars[ , -which(names(trainingSetn2Nvars) %in% c(&quot;gyros_dumbbell_z&quot;,&quot;gyros_forearm_z&quot;,&quot;gyros_forearm_x&quot;,&quot;gyros_arm_z&quot;))]

trainingSetn2Nvars2$classe&lt;-as.factor(trainingSetn2Nvars2$classe)
trainingSetn2Nvars2$user_name&lt;-as.factor(trainingSetn2Nvars2$user_name)

modFit2&lt;-randomForest(trainingSetn2Nvars2[,1:(ncol(trainingSetn2Nvars2)-1)],trainingSetn2Nvars2$classe)
modFit2
</code></pre>

<pre><code>## 
## Call:
##  randomForest(x = trainingSetn2Nvars2[, 1:(ncol(trainingSetn2Nvars2) -      1)], y = trainingSetn2Nvars2$classe) 
##                Type of random forest: classification
##                      Number of trees: 500
## No. of variables tried at each split: 6
## 
##         OOB estimate of  error rate: 0.45%
## Confusion matrix:
##      A    B    C    D    E  class.error
## A 4463    1    0    0    0 0.0002240143
## B   15 3019    4    0    0 0.0062541145
## C    0   14 2721    3    0 0.0062089116
## D    0    0   23 2546    4 0.0104935873
## E    0    0    3    4 2879 0.0024255024
</code></pre>

<p>The out of bag error rate calculated is no better than the model without these variables (and in repeated runs usually was a little worse), so I chose to keep the variables in the model, and use the first model. </p>

<p>This code creates a feature plot for the four variables ranked highest for importance,  showing their relationships to each other and to classe. It shows the partial ability of these variables to separate out classes.</p>

<pre><code class="r">featurePlot(x=trainingSetn2Nvars[,c(&quot;yaw_belt&quot;,&quot;pitch_forearm&quot;,&quot;magnet_dumbbell_z&quot;,&quot;pitch_belt&quot;)],y=trainingSetn2Nvars$classe,plot=&quot;pairs&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-7"/> </p>

<p>This next section evaluates the prediction ability of the model on the testing data.  First it pulls out the variables used in the model for the test set, and then predicts classes from this data.  It then creates a table of the predicted versus actual classes and calculates an Expected Out of Sample Error</p>

<pre><code class="r">set.seed(1)
# Adjust test set data frame to have the same variables as the training set
toTest1&lt;-toTest[,colnames(trainingSetn2Nvars)]
toTest1N&lt;-convert2numeric(toTest1,x=2,y=(ncol(toTest1)-1))
toTest1N$user_name&lt;-as.factor(toTest1N$user_name)

pred1&lt;-as.data.frame(predict(modFit,toTest1N))

predReal1&lt;-cbind(pred1,toTest1N$classe)
colnames(predReal1)&lt;-c(&quot;prediction&quot;,&quot;realClasse&quot;)
table(predReal1$prediction,predReal1$realClasse)
</code></pre>

<pre><code>##    
##        A    B    C    D    E
##   A 1113    6    0    0    0
##   B    2  753    5    0    0
##   C    0    0  679    4    0
##   D    0    0    0  639    0
##   E    1    0    0    0  721
</code></pre>

<pre><code class="r">predReal1$correct&lt;-predReal1$prediction==predReal1$realClasse
fractionCorrect1&lt;-sum(predReal1$prediction==predReal1$realClasse)/nrow(predReal1)
ExpectedOutofSampleError1&lt;-1-fractionCorrect1
ExpectedOutofSampleError1
</code></pre>

<pre><code>## [1] 0.004588325
</code></pre>

<pre><code class="r">print (paste0(&quot;The calculated Expected Out of Sample Error Rate is &quot;,ExpectedOutofSampleError1*100,&quot;%&quot;))
</code></pre>

<pre><code>## [1] &quot;The calculated Expected Out of Sample Error Rate is 0.458832526127961%&quot;
</code></pre>

<p>The Expected Out of Sample Error Rate is listed above.</p>

<p>This section runs the model on the TestData set for submission of class predictions</p>

<pre><code class="r">#see variables in test data
TestData[1,]
</code></pre>

<pre><code>##   X user_name raw_timestamp_part_1 raw_timestamp_part_2   cvtd_timestamp
## 1 1     pedro           1323095002               868349 05/12/2011 14:23
##   new_window num_window roll_belt pitch_belt yaw_belt total_accel_belt
## 1         no         74       123         27    -4.75               20
##   kurtosis_roll_belt kurtosis_picth_belt kurtosis_yaw_belt
## 1                 NA                  NA                NA
##   skewness_roll_belt skewness_roll_belt.1 skewness_yaw_belt max_roll_belt
## 1                 NA                   NA                NA            NA
##   max_picth_belt max_yaw_belt min_roll_belt min_pitch_belt min_yaw_belt
## 1             NA           NA            NA             NA           NA
##   amplitude_roll_belt amplitude_pitch_belt amplitude_yaw_belt
## 1                  NA                   NA                 NA
##   var_total_accel_belt avg_roll_belt stddev_roll_belt var_roll_belt
## 1                   NA            NA               NA            NA
##   avg_pitch_belt stddev_pitch_belt var_pitch_belt avg_yaw_belt
## 1             NA                NA             NA           NA
##   stddev_yaw_belt var_yaw_belt gyros_belt_x gyros_belt_y gyros_belt_z
## 1              NA           NA         -0.5        -0.02        -0.46
##   accel_belt_x accel_belt_y accel_belt_z magnet_belt_x magnet_belt_y
## 1          -38           69         -179           -13           581
##   magnet_belt_z roll_arm pitch_arm yaw_arm total_accel_arm var_accel_arm
## 1          -382     40.7     -27.8     178              10            NA
##   avg_roll_arm stddev_roll_arm var_roll_arm avg_pitch_arm stddev_pitch_arm
## 1           NA              NA           NA            NA               NA
##   var_pitch_arm avg_yaw_arm stddev_yaw_arm var_yaw_arm gyros_arm_x
## 1            NA          NA             NA          NA       -1.65
##   gyros_arm_y gyros_arm_z accel_arm_x accel_arm_y accel_arm_z magnet_arm_x
## 1        0.48       -0.18          16          38          93         -326
##   magnet_arm_y magnet_arm_z kurtosis_roll_arm kurtosis_picth_arm
## 1          385          481                NA                 NA
##   kurtosis_yaw_arm skewness_roll_arm skewness_pitch_arm skewness_yaw_arm
## 1               NA                NA                 NA               NA
##   max_roll_arm max_picth_arm max_yaw_arm min_roll_arm min_pitch_arm
## 1           NA            NA          NA           NA            NA
##   min_yaw_arm amplitude_roll_arm amplitude_pitch_arm amplitude_yaw_arm
## 1          NA                 NA                  NA                NA
##   roll_dumbbell pitch_dumbbell yaw_dumbbell kurtosis_roll_dumbbell
## 1     -17.73748       24.96085      126.236                     NA
##   kurtosis_picth_dumbbell kurtosis_yaw_dumbbell skewness_roll_dumbbell
## 1                      NA                    NA                     NA
##   skewness_pitch_dumbbell skewness_yaw_dumbbell max_roll_dumbbell
## 1                      NA                    NA                NA
##   max_picth_dumbbell max_yaw_dumbbell min_roll_dumbbell min_pitch_dumbbell
## 1                 NA               NA                NA                 NA
##   min_yaw_dumbbell amplitude_roll_dumbbell amplitude_pitch_dumbbell
## 1               NA                      NA                       NA
##   amplitude_yaw_dumbbell total_accel_dumbbell var_accel_dumbbell
## 1                     NA                    9                 NA
##   avg_roll_dumbbell stddev_roll_dumbbell var_roll_dumbbell
## 1                NA                   NA                NA
##   avg_pitch_dumbbell stddev_pitch_dumbbell var_pitch_dumbbell
## 1                 NA                    NA                 NA
##   avg_yaw_dumbbell stddev_yaw_dumbbell var_yaw_dumbbell gyros_dumbbell_x
## 1               NA                  NA               NA             0.64
##   gyros_dumbbell_y gyros_dumbbell_z accel_dumbbell_x accel_dumbbell_y
## 1             0.06            -0.61               21              -15
##   accel_dumbbell_z magnet_dumbbell_x magnet_dumbbell_y magnet_dumbbell_z
## 1               81               523              -528               -56
##   roll_forearm pitch_forearm yaw_forearm kurtosis_roll_forearm
## 1          141          49.3         156                    NA
##   kurtosis_picth_forearm kurtosis_yaw_forearm skewness_roll_forearm
## 1                     NA                   NA                    NA
##   skewness_pitch_forearm skewness_yaw_forearm max_roll_forearm
## 1                     NA                   NA               NA
##   max_picth_forearm max_yaw_forearm min_roll_forearm min_pitch_forearm
## 1                NA              NA               NA                NA
##   min_yaw_forearm amplitude_roll_forearm amplitude_pitch_forearm
## 1              NA                     NA                      NA
##   amplitude_yaw_forearm total_accel_forearm var_accel_forearm
## 1                    NA                  33                NA
##   avg_roll_forearm stddev_roll_forearm var_roll_forearm avg_pitch_forearm
## 1               NA                  NA               NA                NA
##   stddev_pitch_forearm var_pitch_forearm avg_yaw_forearm
## 1                   NA                NA              NA
##   stddev_yaw_forearm var_yaw_forearm gyros_forearm_x gyros_forearm_y
## 1                 NA              NA            0.74           -3.34
##   gyros_forearm_z accel_forearm_x accel_forearm_y accel_forearm_z
## 1           -0.59            -110             267            -149
##   magnet_forearm_x magnet_forearm_y magnet_forearm_z problem_id
## 1             -714              419              617          1
</code></pre>

<pre><code class="r">VarstoTest&lt;-colnames(trainingSetn2Nvars)
#eliminate class from list of vars to test
VarstoTest1&lt;-VarstoTest[-53]
TestData1&lt;-TestData[,VarstoTest1]

#Convert variables to proper classes
TestData1N&lt;-convert2numeric(TestData1,x=2,y=(ncol(TestData1)))
TestData1N$user_name&lt;-as.factor(TestData1N$user_name)

#Predict based on first model above

predTD&lt;-as.data.frame(predict(modFit,TestData1N))

#Write answer files for submission
predTDvec&lt;-as.vector(predTD[,1])
answers&lt;-predTDvec
pml_write_files = function(x){
  n = length(x)
  for(i in 1:n){
    filename = paste0(&quot;problem_id_&quot;,i,&quot;.txt&quot;)
    write.table(x[i],file=filename,quote=FALSE,row.names=FALSE,col.names=FALSE)
  }
}
pml_write_files(answers)
</code></pre>

</body>

</html>

